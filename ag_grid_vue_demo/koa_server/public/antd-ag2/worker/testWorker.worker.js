import{RequestItem,BatchRequest}from"@/components/AgGridTable/common/utils/batchRequest";async function batchRequestFun(e){const{totalPage:t,pageNum:s,pageSize:a}=e,o=[];for(let u=s;u<t;u++){const e=new RequestItem({reqParams:{id:u+1,url:"/api/order/list",method:"post",data:{pageSize:a,pageNum:u+1}},validateReqParamsFun:e=>{if(!e?.url)return"请求ajaxItem不能为空";const t=e?.method;if(t){const e=["GET","POST"];if(!e.includes(t.toUpperCase()))return`请求方式不满足【${e.join("/")}】其中之一`}},dealResFun:e=>{const t={status:RequestItem.REQ_FAIL_STATUS,response:null};return 200===e?.code?(t.status=RequestItem.REQ_SUCCESS_STATUS,t.response=e?.data):500===e?.code&&(t.status=RequestItem.REQ_FAIL_STATUS,t.response=e?.data),t}});o.push(e)}const n=new BatchRequest(o,3),c=await n.concurRequest();return c}self.onmessage=async function(e){try{const t=e.data[0];console.log("batchExportExcelWorker.js中配置参数=====>",t);const{total:s,pageNum:a,pageSize:o}=t,n=Math.ceil(s/o);console.log("pageNum",a),console.log("totalPage",n);const c=n-a;console.log("realTotalPage",c);const u=await batchRequestFun({totalPage:c,pageNum:a,pageSize:o});console.log("result=====>",u),self.postMessage(u)}catch(t){console.error(t.message||"batchExportExcelWorker.js执行失败")}};
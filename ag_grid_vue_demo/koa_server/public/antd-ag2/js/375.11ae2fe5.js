"use strict";(self["webpackChunkAG"]=self["webpackChunkAG"]||[]).push([[375],{97375:function(e,t,a){a.r(t),a.d(t,{default:function(){return N}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("div",{staticClass:"login-form"},[a("div",{staticClass:"login-form-title"},[e._v("AG-Grid管理系统")]),a("div",{staticClass:"login-form-content"},[a("a-form",{staticClass:"user-layout-login",attrs:{form:e.form}},[a("a-tabs",{attrs:{activeKey:e.customActiveKey,tabBarStyle:{borderBottom:"unset",display:"flex",justifyContent:"center",userSelect:"none"}},on:{change:e.handleTabClick}},[a("a-tab-pane",{key:"accountLogin",staticClass:"left",attrs:{tab:"账号密码登录"}},["accountLogin"===e.customActiveKey?a("div",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userName",e.validatorRules.userName],expression:"['userName', validatorRules.userName]"}],attrs:{size:"large",type:"text",placeholder:"请输入账号",allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",e.validatorRules.password],expression:"['password', validatorRules.password]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"请输入密码",allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",e.validatorRules.captcha],expression:"['captcha', validatorRules.captcha]"}],staticClass:"svgCaptcha",attrs:{size:"large",type:"text",placeholder:"请输入验证码",allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"safety-certificate"},slot:"prefix"}),a("span",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[a("span",{attrs:{id:"svgCaptcha"},on:{click:function(t){return e.getSendSvgCaptchaFun()}}})])],1)],1)],1):e._e()]),a("a-tab-pane",{key:"emailLogin",staticClass:"left",attrs:{tab:"邮箱登录"}},["emailLogin"===e.customActiveKey?a("div",[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",e.validatorRules.email],expression:"['email', validatorRules.email]"}],attrs:{size:"large",type:"text",placeholder:"请输入邮箱",maxLength:35,allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input-search",{directives:[{name:"decorator",rawName:"v-decorator",value:["verifyCode",e.validatorRules.verifyCode],expression:"['verifyCode', validatorRules.verifyCode]"}],attrs:{size:"large",autocomplete:"false",placeholder:"请输入验证码",maxLength:6},on:{search:e.getverifyCode}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"}),a("a-button",{attrs:{slot:"enterButton",diasbled:e.verifyCodeState.smsSendBtn},slot:"enterButton"},[e._v(" "+e._s(e.verifyCodeState.smsSendBtn?e.verifyCodeState.time+"s后重新发送":"发送邮箱验证码")+" ")])],1)],1)],1):e._e()])],1),a("div",{staticClass:"login-form-registerAndForgetPwd"},[a("a-button",{attrs:{type:"link",size:"small"},on:{click:function(t){return e.forgetPwd()}}},[e._v("忘记密码?")]),a("a-button",{attrs:{type:"link",size:"small"},on:{click:function(t){return e.register()}}},[e._v("没有账号，去注册")])],1),a("a-form-item",{staticStyle:{"margin-top":"24px"}},[a("a-button",{staticClass:"login-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.submitLoginLoading},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.submitAndLogin()}}},[e._v("确定")])],1)],1),e._m(0)],1)]),a("ForgetPwdDialog",{attrs:{visible:e.openForgetPwdDialog},on:{"update:visible":function(t){e.openForgetPwdDialog=t}}}),a("RegisterFormDialog",{attrs:{visible:e.openRegisterFormDialog},on:{"update:visible":function(t){e.openRegisterFormDialog=t}}})],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-form-copyright"},[e._v(" XXX-Admin ©2024 Created by "),a("a",{attrs:{href:"https://juejin.cn/user/3633260177130872"}},[e._v("@前端梭哈攻城狮")])])}],i=a(12404),o=a(63435),l=a(95932),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BLModal",{staticClass:"RegisterForm",attrs:{title:"注册",visible:e.visible,okButtonProps:{htmlType:"submit"},confirmLoading:e.submitLoading,width:"500px"},on:{cancel:e.handleCancel,ok:e.handleSubmit}},[a("a-form",{staticClass:"user-layout-login",attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"用户名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userName",e.validatorRules.userName],expression:"['userName', validatorRules.userName]"}],attrs:{size:"large",type:"text",placeholder:"请输入用户名",allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("a-form-item",{attrs:{label:"手机号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phoneNumber",e.validatorRules.phoneNumber],expression:"['phoneNumber', validatorRules.phoneNumber]"}],attrs:{size:"large",type:"text",placeholder:"请输入手机号",maxLength:11,allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"phone"},slot:"prefix"})],1)],1),a("a-form-item",{attrs:{label:"邮箱"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",e.validatorRules.email],expression:"['email', validatorRules.email]"}],attrs:{size:"large",type:"text",placeholder:"请输入手机号",maxLength:50,allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1),a("a-form-item",{attrs:{label:"密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",e.validatorRules.password],expression:"['password', validatorRules.password]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"请输入密码",allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),a("a-form-item",{attrs:{label:"确认密码"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirmPassword",e.validatorRules.confirmPassword],expression:"['confirmPassword', validatorRules.confirmPassword]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"请输入确认密码",allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1)],1)},d=[],m=a(89467),c={name:"RegisterFormDialog",props:{visible:{type:Boolean,default:!1}},data(){return{submitLoading:!1,form:this.$form.createForm(this,{name:"registerForm"}),validatorRules:{userName:{rules:[{required:!0,message:"请输入用户名!"},{validator:o.RO}]},password:{rules:[{required:!0,message:"请输入密码!"},{validator:o.Ij}]},confirmPassword:{rules:[{required:!0,message:"请输入确认密码!"},{validator:this.isConfirmPassword}]},phoneNumber:{rules:[{required:!0,message:"请输入手机号!"},{validator:o.I8}]},email:{rules:[{required:!0,message:"请输入邮箱!"},{validator:o.xf}]}}}},methods:{isConfirmPassword(e,t,a){let r=this.form.getFieldValue("password");void 0!==t?t&&r&&t.trim()!==r.trim()?a(new Error("两次密码不一致")):a():a(new Error("请输入确认密码"))},handleCancel(){this.$emit("update:visible",!1)},handleSubmit(){m.log("提交表单"),this.form.validateFields(((e,t)=>{e||(m.log("校验表单成功",t),(0,l.kz)(t).then((e=>{m.log("注册表单",e),200===e.code?(this.$message.success("注册成功"),this.handleCancel()):this.$message.error(e.message||"注册失败")})))}))}}},u=c,p=a(15627),v=(0,p.A)(u,n,d,!1,null,"4f7d9e25",null),g=v.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{staticClass:"RegisterForm",attrs:{title:"忘记密码",visible:e.visible,okButtonProps:{htmlType:"submit"},confirmLoading:e.submitLoading},on:{cancel:e.handleCancel,ok:e.handleSubmit}},[a("a-form",{staticClass:"user-layout-login",attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"邮箱"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",e.validatorRules.email],expression:"['email', validatorRules.email]"}],attrs:{size:"large",type:"text",placeholder:"请输入邮箱",allowClear:""}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input-search",{directives:[{name:"decorator",rawName:"v-decorator",value:["verifyCode",e.validatorRules.verifyCode],expression:"['verifyCode', validatorRules.verifyCode]"}],attrs:{size:"large",autocomplete:"false",placeholder:"请输入验证码",maxLength:6},on:{search:e.getverifyCode}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"}),a("a-button",{attrs:{slot:"enterButton",diasbled:e.verifyCodeState.smsSendBtn},slot:"enterButton"},[e._v(" "+e._s(e.verifyCodeState.smsSendBtn?e.verifyCodeState.time+"s后重新发送":"发送邮箱验证码")+" ")])],1)],1)],1)],1)},h=[],y=a(89467),C={name:"ForgetPwdDialog",props:{visible:{type:Boolean,default:!1}},data(){return{submitLoading:!1,form:this.$form.createForm(this,{name:"registerForm"}),validatorRules:{email:{rules:[{required:!0,message:"请输入邮箱!"},{validator:o.xf}]},verifyCode:{rules:[{required:!0,message:"请输入验证码!"},{validator:o.sq}]}},verifyCodeState:{time:60,timer:null,smsSendBtn:!1}}},methods:{...(0,i.i0)("user",["sendEMailCodeFun"]),handleCancel(){this.$emit("update:visible",!1)},handleSubmit(){this.form.validateFields(((e,t)=>{e||(this.submitLoading=!0,(0,l.IQ)(t).then((e=>{200===e.code&&this.$message.success(e?.message||"重置成功")})).finally((()=>{this.submitLoading=!1})))}))},async countDownFun(e){const t=this;this.verifyCodeState.smsSendBtn=!0;const a=e=>{clearInterval(e),this.verifyCodeState.timer=null,this.verifyCodeState.time=60,this.verifyCodeState.smsSendBtn=!1},r=this.verifyCodeState.timer;if(r)a(r);else{this.verifyCodeState.timer=setInterval((()=>{t.verifyCodeState.time<=0&&a(t.verifyCodeState.timer),t.verifyCodeState.time--}),1e3);const s=await this.sendEMailCodeFun(e);this.$message.success(s),a(r)}},getverifyCode(e){y.log("获取验证码",e),this.form.validateFields(["email"],(async(e,t)=>{if(!e){y.log("校验表单成功",t);const e={email:t.email,codeType:"resetPwd"};y.log("formData",e),this.countDownFun(e)}}))}}},b=C,w=(0,p.A)(b,f,h,!1,null,"14950a5c",null),x=w.exports,S=a(89467),F={name:"LoginPage",components:{RegisterFormDialog:g,ForgetPwdDialog:x},data(){return{customActiveKey:"accountLogin",form:this.$form.createForm(this,{name:"blqcLoginForm"}),validatorRules:{userName:{initialValue:"",rules:[{required:!0,message:"请输入用户名!"},{validator:o.RO}]},password:{initialValue:"",rules:[{required:!0,message:"请输入密码!",validator:"blur"},{validator:o.Ij}]},captcha:{initialValue:"",rules:[{required:!0,message:"请输入图形验证码!",validator:"blur"}]},phoneNumber:{rules:[{required:!0,message:"请输入邮箱!"},{validator:o.I8}]},email:{rules:[{required:!0,message:"请输入邮箱!"},{validator:o.xf}]},verifyCode:{rules:[{required:!0,message:"请输入验证码!"},{validator:o.IB}]}},verifyCodeState:{time:60,timer:null,smsSendBtn:!1},submitLoginLoading:!1,openForgetPwdDialog:!1,openRegisterFormDialog:!1,svgCaptchaInfo:{img:"",uuid:""}}},created(){this.getSendSvgCaptchaFun()},methods:{...(0,i.i0)("user",["login","sendEMailCodeFun"]),handleTabClick(e){this.customActiveKey=e,"accountLogin"===e&&this.getSendSvgCaptchaFun()},async countDownFun(e){const t=this;this.verifyCodeState.smsSendBtn=!0;const a=e=>{clearInterval(e),this.verifyCodeState.timer=null,this.verifyCodeState.time=60,this.verifyCodeState.smsSendBtn=!1},r=this.verifyCodeState.timer;if(r)a(r);else{this.verifyCodeState.timer=setInterval((()=>{t.verifyCodeState.time<=0&&a(t.verifyCodeState.timer),t.verifyCodeState.time--}),1e3);const s=await this.sendEMailCodeFun(e);this.$message.success(s),a(r)}},getverifyCode(e){S.log("获取验证码",e),this.form.validateFields(["email"],(async(e,t)=>{if(!e){S.log("校验表单成功",t);const e={email:t.email,codeType:"preLoginVerifyCode"};S.log("formData",e),this.countDownFun(e)}}))},forgetPwd(){S.log("忘记密码"),this.openForgetPwdDialog=!0},register(){S.log("没有账号，去注册"),this.openRegisterFormDialog=!0},getSendSvgCaptchaFun(){(0,l.V4)().then((e=>{if(S.log("getSendSvgCaptchaFun=====>",e),200===e.code){const t=e?.data;this.svgCaptchaInfo=t;const a=document.getElementById("svgCaptcha");a.innerHTML=t.img,this.$nextTick((()=>{this.form.setFieldsValue({captcha:t.text})}))}else this.$message.error(e?.message||"获取图形验证码失败")}))},submitAndLogin(){S.log("提交表单");const e=this;this.form.validateFields(((t,a)=>{t||(S.log("校验表单成功",a),this.submitLoginLoading=!0,this.login(a).then((t=>{t?e.$router.push({path:e.$route.query.redirect||"/index"}):this.$message.error("登录失败")})).catch((()=>{this.submitLoginLoading=!1})).finally((()=>{this.submitLoginLoading=!1})))}))}}},R=F,L=(0,p.A)(R,r,s,!1,null,"0ee7d22b",null),N=L.exports}}]);
//# sourceMappingURL=375.11ae2fe5.js.map
"use strict";(self["webpackChunkAG"]=self["webpackChunkAG"]||[]).push([[726],{6466:function(e,t,a){var i=a(82722),s=a(24806),o=a(99139),r=a(89467);const n={data(){return{editRowData:null,rowSelectedList:null,random6DigitNumber:(0,o.Oh)(),gridOptions:{rowHeight:36},agTableOptions:{theme:"alpine",style:null,agTableApi:null,initTable:null,initColumnDefs:null,columnDefs:[],rowData:[],gridOptions:null,defaultColDef:null},agQueryParams:{initTableSuccess:!0,getDataLoading:!0,totalPages:0,total:0,pageNum:1,pageSize:100,filterChangedObj:{},queryParam:{},toggleSearchStatus:!1}}},computed:{eventName(){const{initColumnDefs:e}=this.agTableOptions;return e&&e.agGridTableId?e.agGridTableId:void 0}},watch:{eventName(e){if(e){const t=this;s.iN.setEventBusListener(e,(e=>{t.agTableRowOperation(e)}))}}},beforeDestory(){this.eventName&&s.iN.removeEventBusListener(this.eventName),this.agTableOptions.agTableApi.gridApi.destroy(),this.agQueryParams.getDataLoading=!0,this.agTableOptions.style=null,this.agTableOptions.agTableApi=null,this.agTableOptions.initTable=null,this.agTableOptions.initColumnDefs=null,this.agTableOptions.defaultColDef=null,this.agTableOptions.gridOptions=null,this.agTableOptions.rowData=null,this.rowSelectedList=null,this.agQueryParams.filterChangedObj={},this.agQueryParams.queryParam={}},created(){if(!this.fieldsConfig)return r.error("ag-grid参数[fieldsConfig]是必填项"),!1;!1!==this.fieldsConfig.isDefaultDealQueryParamObj&&this.dealQueryParamObj(),!1!==this.fieldsConfig.isDefaultInitAgGridTable&&this.initTable()},methods:{getCustmoerGridOptions(){const e={rowHeight:80,headerHeight:60,rowSelection:"single",rowStyle:{backgroundColor:"#D3D3D3"},getRowHeight:function(e){return"bottom"===e.node.rowPinned?36:80}};return e},getCustomerDefaultColDef(){return{cellStyle:function(e){return"bottom"===e.node.rowPinned?{color:"#333","line-height":"36px",height:"36px"}:{color:"#ff0","line-height":"80px"}}}},dealQueryParamObj(){if(this.headerSearchConfig){const{main:t,more:a}=this.headerSearchConfig;if((0,i.isArray)(t)&&t.length){const s={};var e=[...t];(0,i.isArray)(a)&&a.length&&(e=[...t,...a]),e.forEach((e=>{const{field:t,type:a,defaultValue:i,selectDefaultValue:o,selectField:r}=e;"region"===a?s[t]=i||[]:(t&&(s[t]=i),r&&(s[r]=o))})),r.log("obj=====>",s),this.$set(this.agQueryParams,"queryParam",s),this.$set(this.agQueryParams,"isChangeQueryCondition",!1),this.$set(this.agQueryParams,"searchRequestCount",0),this.$set(this.agQueryParams,"resetQueryParams",(0,i.cloneDeep)(s))}}},searchReset(){r.log("查询=====12");const{queryParam:e,resetQueryParams:t}=this.agQueryParams;this.agQueryParams.searchRequestCount=0,this.agQueryParams=Object.assign(this.agQueryParams,{initTableSuccess:!0,getDataLoading:!1,totalPages:0,total:0,pageNum:1,pageSize:100,filterChangedObj:{},queryParam:Object.assign(e,t||{}),toggleSearchStatus:!1}),this.geAjaxList()},requestNextPage(e){r.log("请求下一页"),this.agQueryParams.totalPages>this.agQueryParams.pageNum&&(e?this.agQueryParams.pageNum=e:this.agQueryParams.pageNum++,this.geAjaxList(this.agQueryParams.queryParam))},rowSelected(e){r.log("获取多选的行数据",e);const t=this.agTableOptions.agTableApi.getSelectedRows(!1);r.log("获取多选的行数据123",t),this.rowSelectedList=t||[]},getRowData(e){this.editRowData=e},getGridApi(e){const t=new s.iN(e,this.fieldsConfig);r.log("agTableApi======>",t),this.agTableOptions.agTableApi=t},async initTable(){try{const{style:e}=this.fieldsConfig;this.agQueryParams.initTableSuccess=!1,this.agQueryParams.pageNum=1;const t=new s.nv,a=await t.judgeReadServerFieldsData(this.fieldsConfig);this.agTableOptions.columnDefs=a,this.agTableOptions.initColumnDefs=t,this.agTableOptions.initTable||(this.agTableOptions.initTable=this.initTable),e&&(0,i.isObject)(e)&&!(0,i.isEmpty)(e)&&(this.agTableOptions.style=e),this.agQueryParams.initTableSuccess=!0,this.geAjaxList()}catch(e){r.error("err=====>",e),this.$message.error(e?.message||"初始化表格函数[initTable]报错")}},geAjaxList(e={}){this.getList&&"function"===typeof this.getList?this.getList(e):!1!==this.fieldsConfig.isDefaultInitAgGridTable?r.error("getList查询接口方法是必要方法，请检查父组件是否有填写"):r.error("fieldsConfig对象中的[isDefaultInitAgGridTable]属性已经设置为false,请在父组件中methods编写[geAjaxList]方法替代混入的[geAjaxList]方法")}}};t.A=n},89726:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"BasePage"},[a("div",{staticClass:"BasePage-header"},[a("div",{staticClass:"BasePage-header-query"},[a("BLHeaderSearch",{ref:"BLHeaderSearch",attrs:{"header-search-config":e.headerSearchConfig,"ag-query-params":e.agQueryParams,"get-list":e.getList,"search-reset":e.searchReset}})],1),a("div",{staticClass:"BasePage-header-btn"},[a("BLHeaderBtn",{attrs:{"row-selected-list":e.rowSelectedList,"btn-config-list":e.btnConfigList},on:{headerBtnOperation:e.headerBtnOperation}})],1)]),a("AgGridTable",{attrs:{"ag-table-options":Object.assign({},e.agTableOptions,{gridOptions:e.getCustmoerGridOptions}),"ag-table-switch":{isScrollEndRequest:!0,isShowExcelDownload:!0,drawerDoubleShow:!0},rowSelection:"single","query-params":e.agQueryParams},on:{getRowData:e.getRowData,getGridApi:e.getGridApi,rowSelected:e.rowSelected,requestNextPage:e.requestNextPage}}),a("AddDictDialog",{attrs:{visible:e.oprnAddDictDialog,rowInfo:e.selectedRowInfo},on:{"update:visible":function(t){e.oprnAddDictDialog=t},success:e.searchQuery}}),a("ChildDictDialog",{attrs:{visible:e.openChildDictDialog,rowInfo:e.selectedRowInfo},on:{"update:visible":function(t){e.openChildDictDialog=t},success:e.searchQuery}})],1)},s=[],o=a(6466),r=a(95932),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:"bottom"!==e.params.node.rowPinned,expression:"params.node.rowPinned !== 'bottom'"}],staticClass:"AgRowActionBtn",on:{click:function(e){e.stopPropagation()}}},[a("BLButton",{staticClass:"AgRowActionBtn-btn",attrs:{type:"link"},on:{click:function(t){return e.operation(e.params,"编辑")}}},[e._v("编辑")]),a("BLButton",{staticClass:"AgRowActionBtn-btn",attrs:{type:"link"},on:{click:function(t){return e.operation(e.params,"设置")}}},[e._v(" 设置 ")]),a("BLButton",{staticClass:"AgRowActionBtn-btn",attrs:{type:"link"},on:{click:function(t){return e.operation(e.params,1===e.params.data.dicState?"禁用":"启用")}}},[e._v(e._s(1===e.params.data.dicState?"禁用":"启用"))]),a("BLButton",{staticClass:"AgRowActionBtn-btn",attrs:{type:"link"},on:{click:function(t){return e.operation(e.params,"删除")}}},[e._v("删除")])],1)},l=[],d=a(24806),c=a(89467),g={name:"AgRowActionBtn",methods:{operation(e,t){c.log("params",e);const a=e.colDef?.colId;c.log("colId=====>",a),a?d.iN.EventBus.$emit(a,{btnText:t,params:e}):this.$message.warning("表格操作事件colId未绑定，请联系管理员")}}},u=g,h=a(15627),m=(0,h.A)(u,n,l,!1,null,"3035c00c",null),p=m.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BLModal",{staticClass:"RegisterForm",attrs:{title:e.rowInfo&&e.rowInfo.id?"编辑字典":"新增字典",visible:e.visible,okButtonProps:{htmlType:"submit"},confirmLoading:e.submitLoading,width:"500px"},on:{cancel:e.handleCancel,ok:e.handleSubmit}},[a("a-form",{staticClass:"user-layout-login",attrs:{form:e.form,layout:"horizontal"}},[a("a-form-item",{attrs:{label:"字典label"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dicLabel",{rules:[{required:!0,message:"请输入字典label"}]}],expression:"[\n          'dicLabel',\n          {\n            rules: [{ required: true, message: '请输入字典label' }],\n          },\n        ]"}],attrs:{type:"text",placeholder:"请输入字典label",allowClear:""}})],1),a("a-form-item",{attrs:{label:"字典value"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["dicValue",{rules:[{required:!0,message:"请输入字典value"}]}],expression:"[\n          'dicValue',\n          {\n            rules: [{ required: true, message: '请输入字典value' }],\n          },\n        ]"}],attrs:{type:"text",placeholder:"请输入字典value",allowClear:""}})],1),a("a-form-item",{attrs:{label:"额外参数"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["dicExtraParams"],expression:"['dicExtraParams']"}],attrs:{placeholder:"请输入额外参数",rows:"3",maxLength:120}})],1),a("a-form-item",{attrs:{label:"备注"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["dicRemark"],expression:"['dicRemark']"}],attrs:{placeholder:"请输入备注",rows:"3",maxLength:120}})],1)],1)],1)},f=[],w=a(89467),y={name:"ResetPwdDialog",props:{visible:{type:Boolean,default:!1},bindId:{type:Number|String,default:""},rowInfo:{type:Object,default(){return{}}}},data(){return{submitLoading:!1,form:this.$form.createForm(this,{name:"resetPwdForm"})}},watch:{visible(e){e&&this.initModal()}},methods:{initModal(){const e=this.rowInfo,t=e?.id;t&&this.$nextTick((()=>{this.form.setFieldsValue({dicLabel:e.dicLabel,dicValue:e.dicValue,dicExtraParams:e.dicExtraParams,dicRemark:e.dicRemark})}))},handleCancel(){this.form.resetFields(),this.$emit("update:visible",!1)},handleSubmit(){this.form.validateFields(((e,t)=>{if(!e){w.log("values=====>",t);const e=this.rowInfo?.id;this.bindId&&(t.dicBindId=this.bindId),e?(t.id=e,this.editDictFun(t)):this.addDictFun(t)}}))},addDictFun(e){this.submitLoading=!0,(0,r.iM)(e).then((e=>{200===e.code&&(this.$message.success(e?.message||"新增成功"),this.handleCancel(),this.$emit("success"))})).finally((()=>{this.submitLoading=!1}))},editDictFun(e){this.submitLoading=!0,(0,r.F)(e).then((e=>{200===e.code&&(this.$message.success(e?.message||"编辑成功"),this.handleCancel(),this.$emit("success"))})).finally((()=>{this.submitLoading=!1}))}}},D=y,P=(0,h.A)(D,b,f,!1,null,"1919c10d",null),A=P.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BLModal",{staticClass:"ChildDictDialog",attrs:{title:"设置字典项",visible:e.visible,okButtonProps:{htmlType:"submit"},confirmLoading:e.submitLoading,width:"80%"},on:{cancel:e.handleCancel,ok:e.handleSubmit}},[a("div",{staticClass:"ChildDictDialog-header"},[a("BLHeaderBtn",{attrs:{"row-selected-list":e.rowSelectedList,"btn-config-list":e.btnConfigList},on:{headerBtnOperation:e.headerBtnOperation}})],1),a("AgGridTable",{attrs:{"ag-table-options":e.agTableOptions,"ag-table-switch":{isScrollEndRequest:!0,isShowExcelDownload:!0,drawerDoubleShow:!1},"query-params":e.agQueryParams},on:{getRowData:e.getRowData,getGridApi:e.getGridApi,rowSelected:e.rowSelected,requestNextPage:e.requestNextPage}}),a("AddDictDialog",{attrs:{visible:e.oprnAddDictDialog,bindId:e.rowInfo&&e.rowInfo.id?e.rowInfo.id:"",rowInfo:e.selectedRowInfo},on:{"update:visible":function(t){e.oprnAddDictDialog=t},success:e.getList}})],1)},v=[],L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:"bottom"!==e.params.node.rowPinned,expression:"params.node.rowPinned !== 'bottom'"}],staticClass:"AgRowActionBtn",on:{click:function(e){e.stopPropagation()}}},[a("BLButton",{staticClass:"AgRowActionBtn-btn",attrs:{type:"link"},on:{click:function(t){return e.operation(e.params,"编辑")}}},[e._v("编辑")]),a("BLButton",{staticClass:"AgRowActionBtn-btn",attrs:{type:"link"},on:{click:function(t){return e.operation(e.params,1===e.params.data.dicState?"禁用":"启用")}}},[e._v(e._s(1===e.params.data.dicState?"禁用":"启用"))]),a("BLButton",{staticClass:"AgRowActionBtn-btn",attrs:{type:"link"},on:{click:function(t){return e.operation(e.params,"删除")}}},[e._v("删除")])],1)},S=[],T=a(89467),B={name:"AgRowActionBtn",methods:{operation(e,t){T.log("params",e);const a=e.colDef?.colId;T.log("colId=====>",a),a?d.iN.EventBus.$emit(a,{btnText:t,params:e}):this.$message.warning("表格操作事件colId未绑定，请联系管理员")}}},O=B,R=(0,h.A)(O,L,S,!1,null,"7f62dbb3",null),k=R.exports,x=a(89467),I={name:"ChildDictDialog",mixins:[o.A],components:{AgRowActionChildBtn:k,AddDictDialog:A},props:{visible:{type:Boolean,default:!1},rowInfo:{type:Object,default(){return{}}}},data(){return{submitLoading:!1,oprnAddDictDialog:!1,btnConfigList:[{btnText:"新增",type:"primary",power:"getTransportNode"}],selectedRowInfo:null,fieldsConfig:{name:"字典项设置",id:"childDictManage",isDefaultInitAgGridTable:!1,style:{height:"450px"},database:{"字典ID":"id","字典label":"dicLabel","字典value":"dicValue","额外参数":"dicExtraParams","备注":"dicRemark","状态":"dicState","创建人":"createBy","创建时间":"createdAt","更新时间":"updatedAt"},specColumns:[{headerName:"状态",field:"dicState",cellRenderer:e=>{if("bottom"!==e.node.rowPinned)return 1==e.value?"开启":"禁用"}}],actionColumns:[{headerName:"操作",field:"agTableAction",width:170,cellRendererFramework:"AgRowActionChildBtn"}]}}},watch:{visible(e){e&&this.initModal()}},methods:{initModal(){x.log("弹窗初始化",this.rowInfo),this.initTable()},getList(){const e=this.rowInfo?.id;if(e){const{pageSize:t,pageNum:a}=this.agQueryParams;1===a&&(this.agTableOptions.rowData=null),this.agQueryParams.getDataLoading=!0,this.rowSelectedList=null,(0,r.V1)({pageSize:t,pageNum:a,queryParams:{dicBindId:e}}).then((e=>{if(200===e?.code){const{data:t,total:i=0,pages:s}=e;this.agQueryParams.total=i,this.agQueryParams.totalPages=s,this.agTableOptions.rowData=a<=1?t:{...this.agTableOptions.rowData,...t}}else this.$message.error(e.message||"查询列表失败")})).finally((()=>{this.agQueryParams.getDataLoading=!1}))}},headerBtnOperation(e){x.log("头部按钮操作",e);const{btnText:t}=e;switch(t){case"新增":x.log("新增"),this.selectedRowInfo=null,this.oprnAddDictDialog=!0;break}},agTableRowOperation(e){const{params:t,btnText:a}=e;x.log("params",t);const i=t.data;switch(this.selectedRowInfo=i,a){case"编辑":x.log("编辑"),this.oprnAddDictDialog=!0;break;case"禁用":x.log("禁用"),this.toggleStatus([i],0);break;case"启用":x.log("启用"),this.toggleStatus([i],1);break;case"删除":x.log("删除"),this.deleteConfirm(i.id);break}},toggleStatus(e,t){if(x.log("启用/禁用",e),x.log("启用/dicState",t),e?.length){const a=this,i=e.map((e=>e.id)).join(","),s=0===t?"禁用":"启用";this.$confirm({title:"温馨提示",content:`您确认${s}吗`,onOk:async function(){x.log("提交");const e=await(0,r.IR)({ids:i,dicState:t});200===e.code?(a.$message.success(`${s}成功`),a.getList(a.agQueryParams.queryParam)):a.$message.warning(e.message||`${s}失败`)}})}else this.$message.warning("未选择行数据")},deleteConfirm(e){x.log("ids123123",e);const t=this;this.$confirm({title:"操作确认",content:"删除后无法恢复，您是否确认删除?",onOk:async function(){x.log("提交");const a=await(0,r.c7)({ids:e});200===a.code?(t.$message.success("删除成功"),t.getList(t.agQueryParams.queryParam)):t.$message.warning(a.message||"删除失败")}})},handleCancel(){this.$emit("update:visible",!1)},handleSubmit(){this.form.validateFields(((e,t)=>{e||x.log("提交表单")}))}}},Q=I,$=(0,h.A)(Q,C,v,!1,null,"e361848e",null),N=$.exports,q=a(89467),j={name:"ResetPwdDialog",mixins:[o.A],components:{AgRowActionBtn:p,AddDictDialog:A,ChildDictDialog:N},data(){return{oprnAddDictDialog:!1,openChildDictDialog:!1,headerSearchConfig:{displayIndex:2,main:[{type:"fuzzySearch",field:"searchVal",selectField:"inField",defaultValue:void 0,selectDefaultValue:"dicLabel",options:[{label:"字典label",value:"dicLabel"},{label:"字典value",value:"dicValue"}]},{type:"select",field:"dicState",defaultValue:void 0,placeholder:"请选择状态",options:[{label:"禁用",value:0},{label:"启用",value:1}]}]},btnConfigList:[{btnText:"新增",type:"primary",power:"getTransportNode"}],fieldsConfig:{name:"字典管理",id:"dictManage",database:{"字典ID":"id","字典label":"dicLabel","字典value":"dicValue","额外参数":"dicExtraParams","备注":"dicRemark","状态":"dicState","创建人":"createBy","创建时间":"createdAt","更新时间":"updatedAt"},specColumns:[{headerName:"状态",field:"dicState",cellRenderer:e=>{if("bottom"!==e.node.rowPinned)return 1==e.value?"开启":"禁用"}}],actionColumns:[{headerName:"操作",field:"agTableAction",width:170,cellRendererFramework:"AgRowActionBtn"}]},selectedRowInfo:null}},methods:{getCustmoerGridOptions(){const e={rowHeight:36,headerHeight:36,rowStyle:{backgroundColor:"#efefef"},treeData:!0,getDataPath:e=>(q.log("data.path123123",e.path),e.path),getChildCount:function(e){return q.log("data123123123",e),e&&e?.children?e.children.length:0}};return e},searchQuery(e){this.$refs.BLHeaderSearch.searchQuery(e)},recursion(e,t){return Array.isArray(e)&&e.length?t?e.filter((e=>e.id===t)):e.filter((e=>!e.dicBindId)).map((t=>(Array.isArray(t.path)&&t.path?t.path.push(t.id):t.path=[t.id],t.children=this.recursion(e,t.id),t))):null},getList(e){const{pageSize:t,pageNum:a,filterChangedObj:i}=this.agQueryParams;this.agQueryParams.queryParam.isRealField=!0,this.agQueryParams.getDataLoading=!0,1===a&&(this.agTableOptions.rowData=null),this.rowSelectedList=null,(0,r.V1)({pageSize:t,pageNum:a,queryParams:{dicBindId:null,...e||{},...i.filterObj||{}}}).then((e=>{if(200===e?.code){const{data:t,total:i=0,pages:s}=e;this.agQueryParams.total=i,this.agQueryParams.totalPages=s,this.agTableOptions.rowData=a<=1?this.recursion(t):{...this.agTableOptions.rowData,...t}}else this.$message.error(e.message||"查询列表失败")})).finally((()=>{this.agQueryParams.getDataLoading=!1}))},agTableRowOperation(e){const{params:t,btnText:a}=e;q.log("params",t);const i=t.data;switch(this.selectedRowInfo=i,a){case"编辑":q.log("编辑"),this.oprnAddDictDialog=!0;break;case"设置":q.log("设置"),this.openChildDictDialog=!0;break;case"禁用":q.log("禁用"),this.toggleStatus([i],0);break;case"启用":q.log("启用"),this.toggleStatus([i],1);break;case"删除":q.log("删除"),this.deleteConfirm(i.id);break}},toggleStatus(e,t){if(q.log("启用/禁用",e),q.log("启用/dicState",t),e?.length){const a=this,i=e.map((e=>e.id)).join(","),s=0===t?"禁用":"启用";this.$confirm({title:"温馨提示",content:`您确认${s}吗`,onOk:async function(){q.log("提交");const e=await(0,r.IR)({ids:i,dicState:t});200===e.code?(a.$message.success(`${s}成功`),a.getList(a.agQueryParams.queryParam)):a.$message.warning(e.message||`${s}失败`)}})}else this.$message.warning("未选择行数据")},deleteConfirm(e){q.log("ids=====>",e);const t=this;this.$confirm({title:"操作确认",content:"删除后无法恢复，您是否确认删除?",onOk:async function(){q.log("提交");const a=await(0,r.c7)({ids:e});200===a.code?(t.$message.success("删除成功"),t.getList(t.agQueryParams.queryParam)):t.$message.warning(a.message||"删除失败")}})},headerBtnOperation(e){q.log("头部按钮操作",e);const{btnText:t}=e;switch(q.log("this.rowSelectedList",this.rowSelectedList),t){case"新增":q.log("新增"),this.selectedRowInfo=null,this.oprnAddDictDialog=!0;break;case"删除":q.log("删除");break;case"禁用":q.log("禁用");break;case"启用":q.log("启用");break}}}},E=j,F=(0,h.A)(E,i,s,!1,null,"ecb68c4e",null),_=F.exports}}]);
//# sourceMappingURL=726.bbd8b4e1.js.map
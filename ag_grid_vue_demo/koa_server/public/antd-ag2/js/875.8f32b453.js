"use strict";(self["webpackChunkAG"]=self["webpackChunkAG"]||[]).push([[875],{90875:function(e,a,t){t.r(a),t.d(a,{default:function(){return c}});var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BLModal",{staticClass:"RegisterForm",attrs:{title:e.rowInfo?"编辑用户":"新增用户",visible:e.visible,okButtonProps:{htmlType:"submit"},confirmLoading:e.submitLoading,width:"700px"},on:{cancel:e.handleCancel,ok:e.handleSubmit}},[t("a-form",{staticClass:"user-layout-login",attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:12}}},[t("a-form-item",{attrs:{label:"用户名"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userName",e.validatorRules.userName],expression:"['userName', validatorRules.userName]"}],attrs:{type:"text",placeholder:"请输入用户名",allowClear:""}},[t("a-icon",{style:e.defaultStyle,attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t("a-form-item",{attrs:{label:"手机号"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phoneNumber",e.validatorRules.phoneNumber],expression:"['phoneNumber', validatorRules.phoneNumber]"}],attrs:{type:"text",placeholder:"请输入手机号",maxLength:11,allowClear:""}},[t("a-icon",{style:e.defaultStyle,attrs:{slot:"prefix",type:"phone"},slot:"prefix"})],1)],1),t("a-form-item",{attrs:{label:"邮箱"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",e.validatorRules.email],expression:"['email', validatorRules.email]"}],attrs:{type:"text",placeholder:"请输入邮箱",maxLength:50,allowClear:""}},[t("a-icon",{style:e.defaultStyle,attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1),t("a-form-item",{attrs:{label:"用户角色"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["userRole",e.validatorRules.userRole],expression:"['userRole', validatorRules.userRole]"}],attrs:{placeholder:"请选择用户角色",allowClear:""}},[t("a-select-option",{attrs:{value:"超级管理员"}},[e._v(" 超级管理员 ")]),t("a-select-option",{attrs:{value:"管理员"}},[e._v(" 管理员 ")]),t("a-select-option",{attrs:{value:"普通用户"}},[e._v(" 普通用户 ")])],1)],1),t("a-form-item",{attrs:{label:"用户图片"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userImg",e.validatorRules.userImg],expression:"['userImg', validatorRules.userImg]"}],attrs:{type:"text",placeholder:"请输入用户图片",allowClear:""}})],1),t("a-form-item",{attrs:{label:"真实姓名"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["realName",e.validatorRules.realName],expression:"['realName', validatorRules.realName]"}],attrs:{type:"text",placeholder:"请输入真实姓名",maxLength:11,allowClear:""}},[t("a-icon",{style:e.defaultStyle,attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t("a-form-item",{attrs:{label:"身份证号"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["idCardNo",e.validatorRules.idCardNo],expression:"['idCardNo', validatorRules.idCardNo]"}],attrs:{type:"text",placeholder:"请输入身份证号",maxLength:18,allowClear:""}})],1),t("a-form-item",{attrs:{label:"性别"}},[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["sex",e.validatorRules.sex],expression:"['sex', validatorRules.sex]"}]},[t("a-radio",{attrs:{value:1}},[e._v(" 男 ")]),t("a-radio",{attrs:{value:0}},[e._v("女")])],1)],1),t("a-form-item",{attrs:{label:"生日"}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["birthday"],expression:"['birthday']"}],attrs:{placeholder:"请选择您的生日"}})],1),t("a-form-item",{attrs:{label:"省市区"}},[t("BLRegion",{directives:[{name:"decorator",rawName:"v-decorator",value:["pcaRegion"],expression:"[`pcaRegion`]"}],attrs:{regionType:"pca"},on:{change:e.pcaRegionChange}})],1),t("a-form-item",{attrs:{label:"详细地址"}},[t("BLRegionAddress",{directives:[{name:"decorator",rawName:"v-decorator",value:["address"],expression:"[`address`]"}],style:{width:"300px"},attrs:{location:e.locationCity,"max-length":100},on:{mapMoveend:e.mapMoveendChange}})],1),t("a-form-item",{attrs:{label:"用户状态"}},[t("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["userState",e.validatorRules.userState],expression:"['userState', validatorRules.userState]"}]},[t("a-radio",{attrs:{value:1}},[e._v("启用")]),t("a-radio",{attrs:{value:0}},[e._v("禁用")])],1)],1),t("a-form-item",{attrs:{label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"['remark']"}],attrs:{placeholder:"请输入备注",rows:"4",maxLength:120}})],1)],1)],1)},s=[],i=t(63435),o=t(95932),l=t(89467),d={name:"AddUser",props:{visible:{type:Boolean,default:!1},rowInfo:{type:Object,default(){return{}}}},data(){return{submitLoading:!1,form:this.$form.createForm(this,{name:"AddUserForm"}),defaultStyle:{color:"rgba(0,0,0,.25)"},locationCity:"深圳",locationObj:{longitude:void 0,latitude:void 0},validatorRules:{userName:{rules:[{required:!0,message:"请输入用户名!"}]},phoneNumber:{rules:[{required:!0,message:"请输入手机号!"},{validator:i.I8}]},userRole:{initialValue:"普通用户",rules:[{required:!0,message:"请选择用户角色!"}]},email:{rules:[{required:!0,message:"请输入邮箱!"},{validator:i.xf}]},realName:{rules:[{required:!1,message:"请输入真实姓名!"}]},idCardNo:{rules:[{required:!1,message:"请输入身份证号!"}]},sex:{initialValue:0},userState:{initialValue:1,rules:[{required:!0,message:"请选择用户状态"}]}}}},beforeCreate(){},watch:{visible(e){e?this.initModel():this.form.resetFields()}},methods:{initModel(){this.rowInfo?.id&&this.echoForm(this.rowInfo)},echoForm(e){l.log("回显表单"),this.$nextTick((()=>{let a=[];e.provinceId&&e.cityId&&e.areaId&&(a=[e.provinceId,e.cityId,e.areaId]),this.form.setFieldsValue({userName:e.userName,phoneNumber:e.phoneNumber,email:e.email,userImg:e.userImg,realName:e.realName,idCardNo:e.idCardNo,pcaRegion:a,sex:e.sex,userState:e.userState,birthday:e.birthday,address:e.address,remark:e.remark})}))},handleCancel(){this.$emit("update:visible",!1)},pcaRegionChange(e){if(l.log("选择地址更改",e),e&&e.length){const a=this.$region.getRegionCode(e,"name");if(a&&a.length){const[e]=a,t=a.join("");this.locationCity=e,this.$nextTick((()=>{this.form.setFieldsValue({address:t})}))}}else this.locationCity="深圳",this.$nextTick((()=>{this.form.setFieldsValue({address:""})}))},dKRegionAddressChange(e){l.log("地址更改",e),"string"===typeof e&&this.$nextTick((()=>{this.form.setFieldsValue({address:e})}))},mapMoveendChange(e){l.log("地址更改",e),"string"===typeof e&&this.$nextTick((()=>{this.locationObj={longitude:e.lng,latitude:e.lat},this.form.setFieldsValue({address:e.keyword})}))},getSubmitData(e){const{pcaRegion:a,...t}=e,r={...t,...this.locationObj,registerFrom:2},s=this.$region.getRegionCode(a,"name");if(s&&s.length){const[e,t,i]=s,[o,l,d]=a;r.province=e,r.city=t,r.area=i,r.provinceId=o,r.cityId=l,r.areaId=d}return r},handleSubmit(){this.form.validateFields(((e,a)=>{if(!e){l.log("校验表单成功",a);const e=this.getSubmitData(a);l.log("submitData====>",e),this.rowInfo?.id?(e.id=this.rowInfo.id,this.editUserFun(e)):this.addUserFun(e)}}))},editUserFun(e){this.submitLoading=!0,(0,o.gw)(e).then((e=>{l.log("新增用户",e),200===e.code?(this.$message.success("编辑成功"),this.handleCancel(),this.$emit("success")):this.$message.error(e?.message||"编辑失败")})).finally((()=>{this.submitLoading=!1}))},addUserFun(e){this.submitLoading=!0,(0,o.nu)(e).then((e=>{200===e.code?(this.$message.success("新增成功"),this.handleCancel(),this.$emit("success")):this.$message.error(e?.message||"新增失败")})).finally((()=>{this.submitLoading=!1}))}}},n=d,m=t(15627),u=(0,m.A)(n,r,s,!1,null,"5c626106",null),c=u.exports}}]);
//# sourceMappingURL=875.8f32b453.js.map
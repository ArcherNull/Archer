(function(){"use strict";var e={99061:function(e,t,n){var r=n(95714),s=n(74499);n(89467);function a(e,t){t&&(e+=1462);var n=Date.parse(e);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function o(){if(!(this instanceof o))return new o;this.SheetNames=[],this.Sheets={}}function u(e){for(var t={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=e.length;++r)for(var o=0;o!=e[r].length;++o){n.s.r>r&&(n.s.r=r),n.s.c>o&&(n.s.c=o),n.e.r<r&&(n.e.r=r),n.e.c<o&&(n.e.c=o);var u={v:e[r][o]};if(null!=u.v){var c=s.utils.encode_cell({c:o,r:r});"number"===typeof u.v?u.t="n":"boolean"===typeof u.v?u.t="b":u.v instanceof Date?(u.t="n",u.z=s.SSF._table[14],u.v=a(u.v)):u.t="s",t[c]=u}}return n.s.c<1e7&&(t["!ref"]=s.utils.encode_range(n)),t}function c(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function i(e,t){var n=t;n.unshift(e);var r="SheetJS",a=new o,i=u(n);a.SheetNames.push(r),a.Sheets[r]=i;var l=s.write(a,{bookType:"xlsx",bookSST:!1,type:"binary"});return c(l)}function l(e){const{tHeader:t,data:n,lastRow:r}=e;n.push(...r);const s=i(t,n);return s}function f(e,t){const n=e=>{if(e){if(/[Fee|Money|Price|Pay|Weight|Volume]$/g.test(e)){const t=Number(e);return isNaN(t)?e:t.toString().length>10?`'${t}`:t}return e}return e};return t.map((t=>e.map((e=>{const r=t[e];return n(r)}))))}function p(e){return new Promise((t=>{const n=Array.isArray(e.tableData)?f(e.filterVal,e.tableData):[],r={tHeader:e.tHeader,filterVal:e.filterVal,lastRow:e.lastRow||[],title:e.title||"downLoadExcel",data:n},s=l(r);t(s)}))}var g=n(89467);async function d(e,t){g.log("config123123123",e);const{requestParams:n,pageParams:s}=e,{data:a,...o}=n,{pageNum:u,pageSize:c,...i}=a,{totalPage:l}=s,f=[];for(let g=u;g<=l;g++){const e=new r.Z({reqParams:{id:g,...o,data:{pageSize:c,pageNum:g,...i}},validateReqParamsFun:e=>{if(!e?.url)return"请求ajaxItem不能为空";const t=e?.method;if(t){const e=["GET","POST"];if(!e.includes(t.toUpperCase()))return`请求方式不满足【${e.join("/")}】其中之一`}},dealResFun:e=>{const t={status:r.Z.REQ_FAIL_STATUS,response:null};return 200===e?.code?(t.status=r.Z.REQ_SUCCESS_STATUS,t.response=e?.data):500===e?.code&&(t.status=r.Z.REQ_FAIL_STATUS,t.response=e?.data),t}});f.push(e)}const p=new r.q({ajaxLists:f,maxNum:2,callback:t}),d=await p.concurRequest();return d}function h(e){g.log("sortabledFields",e);let t=[],n=[];return e.forEach((e=>{e.hide||(t.push(e.headerName),n.push(e.field))})),{tHeader:t,filterVal:n}}function v(e){const t=[];return e.forEach((e=>{"success"===e.reqStatus&&t.push(...e.response)})),t}self.onmessage=async function(e){try{const t=e.data;g.log("batchExportExcelWorker.js中配置参数=====>",t);const n=e=>{const t=e.map((e=>({reqParams:e.reqParams,reqStatus:e.reqStatus,response:e.response,responseMsg:e.responseMsg})));return t};d(t,(e=>{g.log("回调函数",e);const{status:t,data:r,message:s}=e,{result:a}=r;self.postMessage({status:t,message:s,postResult:n(a)})})).then((e=>{g.log("result=====>",e);const n=v(e),{tHeader:r,filterVal:s}=h(t?.sortabledFields);g.log("tableData123123123",n);const a=p({tHeader:r,filterVal:s,tableData:n});g.log("newBolb13123",a),self.postMessage({status:"request.success",message:`请求完毕【${e.length}/${e.length}】`,postResult:a})}))}catch(t){g.error(t.message||"batchExportExcelWorker.js执行失败")}};const m=()=>{self.postMessage({message:"error",data:[]}),self.close()};self.addEventListener("error",(e=>{m(),g.log("ERROR: Line ",e.lineno," in ",e.filename,": ",e.message)})),self.addEventListener("message",(async()=>{const e={test:"123134"};self.postMessage({message:"success",data:e})}),!1)}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.x=function(){var e=n.O(void 0,[56],(function(){return n(99061)}));return e=n.O(e),e},function(){var e=[];n.O=function(t,r,s,a){if(!r){var o=1/0;for(l=0;l<e.length;l++){r=e[l][0],s=e[l][1],a=e[l][2];for(var u=!0,c=0;c<r.length;c++)(!1&a||o>=a)&&Object.keys(n.O).every((function(e){return n.O[e](r[c])}))?r.splice(c--,1):(u=!1,a<o&&(o=a));if(u){e.splice(l--,1);var i=s();void 0!==i&&(t=i)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[r,s,a]}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+".456899ff.js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/public/antd-ag2/"}(),function(){var e={61:1},t=function(t){var r=t[0],a=t[1],o=t[2];for(var u in a)n.o(a,u)&&(n.m[u]=a[u]);o&&o(n);while(r.length)e[r.pop()]=1;s(t)};n.f.i=function(t,r){e[t]||importScripts(n.p+n.u(t))};var r=self["webpackChunkAG"]=self["webpackChunkAG"]||[],s=r.push.bind(r);r.push=t}(),function(){var e=n.x;n.x=function(){return n.e(56).then(e)}}();n.x()})();
//# sourceMappingURL=61.d2f62146.js.map